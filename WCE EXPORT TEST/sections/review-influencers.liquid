<!-- Page Width Wrappers -->
{% case section.settings.wrapper %}
  {% when 'Full Width' %}
     {%- assign wrapper = 'full-wrapper' -%}
  {% when 'Standard Width' %}
     {%- assign wrapper = 'wrapper' -%}
  {% when 'Small Width' %}
     {%- assign wrapper = 'sml-wrapper' -%}
{% endcase %}

<!-- FLEX Column Dropdowns -->
{% case section.settings.large_columns %}
  {% when '6 Per Column' %}
     {%- assign desktop_columns = 'xl-six-cols' -%}
  {% when '5 Per Column' %}
     {%- assign desktop_columns = 'xl-five-cols' -%}
  {% when '4 Per Column' %}
     {%- assign desktop_columns = 'xl-four-cols' -%}
  {% when '3 Per Column' %}
     {%- assign desktop_columns = 'xl-three-cols' -%}
  {% when '2 Per Column' %}
     {%- assign desktop_columns = 'xl-two-cols' -%}
{% endcase %}

{% case section.settings.desktop_columns %}
  {% when '6 Per Column' %}
     {%- assign desktop_columns = 'd-six-cols' -%}
  {% when '5 Per Column' %}
     {%- assign desktop_columns = 'd-five-cols' -%}
  {% when '4 Per Column' %}
     {%- assign desktop_columns = 'd-four-cols' -%}
  {% when '3 Per Column' %}
     {%- assign desktop_columns = 'd-three-cols' -%}
  {% when '2 Per Column' %}
     {%- assign desktop_columns = 'd-two-cols' -%}
{% endcase %}

{% case section.settings.laptop_columns %}
  {% when '6 Per Column' %}
     {%- assign laptop_columns = 'l-six-cols' -%}
  {% when '5 Per Column' %}
     {%- assign laptop_columns = 'l-five-cols' -%}
  {% when '4 Per Column' %}
     {%- assign laptop_columns = 'l-four-cols' -%}
  {% when '3 Per Column' %}
     {%- assign laptop_columns = 'l-three-cols' -%}
  {% when '2 Per Column' %}
     {%- assign laptop_columns = 'l-two-cols' -%}
{% endcase %}

{% case section.settings.tablet_columns %}
  {% when '3 Per Column' %}
     {%- assign tablet_columns = 't-three-cols' -%}
  {% when '2 Per Column' %}
     {%- assign tablet_columns = 't-two-cols' -%}
  {% when 'Single Column' %}
     {%- assign tablet_columns = '' -%}
{% endcase %}

{% case section.settings.mobile_columns %}
  {% when '2 Per Column' %}
     {%- assign mobile_columns = 'm-two-cols' -%}
  {% when 'Single Column' %}
     {%- assign mobile_columns = '' -%}    
{% endcase %}

<!-- Wrapper Padding -->
{% case section.settings.wrapper_padding %}
  {% when 'Padding Top & Bottom' %}
     {%- assign wrapper_padding = '' -%}
  {% when 'Padding Top Only' %}
     {%- assign wrapper_padding = 'no-pad-bottom' -%}
  {% when 'Padding Bottom Only' %}
     {%- assign wrapper_padding = 'no-pad-top' -%}
  {% when 'No Padding' %}
     {%- assign wrapper_padding = 'no-padding' -%}
{% endcase %}


<!-- STAND CONTENT SECTION -->
<div style="background-color: {{ section.settings.custom_background_color }}">
  <div class="{{ wrapper }} {{ wrapper_padding }}">

    {% if section.settings.title != blank %}
    <div class="block-block-section-title-wrapper">
      <div class="block-section-title-wrap">
          <h2 class="block-section-title">{{ section.settings.title | escape }}</h2>
      </div>
    </div>
    {% endif %}

    
    <div class="flex {{ desktop_columns }} {{ laptop_columns }} {{ tablet_columns }} {{ mobile_columns }}">

      <!-- START BLOCK VIDEO IMAGE -->
      {%for block in section.blocks%}
      <div><div class="inf-video-block inf-trigger" data-tab="inf{{ forloop.index0 }}">
        <div class="inf-video-img">
          <img loading="lazy" src="{{block.settings.image | img_url:'master'}}" alt="{{block.settings.heading}}" height="auto" width="100%">
          {% render 'play-btn' %}
        </div>
        <h3>{{block.settings.heading}}</h3>
      </div></div>
      {%endfor%}  
      
    </div>    
    
    <!-- VIDEO POP UP  -->
    {%for block in section.blocks%}
      <div class="inf-video-popup inf{{ forloop.index0 }}">
        
         {% if block.settings.youtube != blank %}
           <div class="videoWrapper">{{block.settings.youtube}}</div>
         {% else %}            
           <div>{{block.settings.tiktok}}</div>
         {% endif %}
        
         <div class="inf-video-text">
            <h3>{{block.settings.heading}}</h3>
            {{block.settings.text}}
         </div>
      </div>
    {%endfor%}  

    <div class="inf-video-overlay"></div>
    <div class="popup-cross">X</div>
    
  </div>
</div>

<script>
jQuery(function($){ 

  // Video Pop up on Click
  $("body").on("click", ".inf-trigger", function (e) {
      e.preventDefault();
      let $tabs = $(this).parent(),
          x = 0;
      while (!$tabs.find(".inf-video-popup").length && x < 10) {
          $tabs = $tabs.parent();
          x++;
      }
  
      $tabs.find(".inf-video-popup.active,.inf-trigger.active,.inf-video-overlay.active,.popup-cross.active").removeClass("active");
      let a = $(this).attr("data-tab");
      $(this).addClass("active"), $tabs.find(".inf-video-popup." + a).addClass("active");
      $('.inf-video-overlay, .popup-cross').addClass("active");
  
  });


    $('.inf{{ forloop.index0 }}').on('pumBeforeClose', function () {
        var $iframe = $('iframe', $(this)),
        src = $iframe.prop('src');
        $iframe.prop('src', '').prop('src', src.replace('?autoplay=1', ''));
    });

  //Close video pop up
  $(".inf-video-overlay, .popup-cross").on("click", function(){
    var $vidsrc =  $('.inf-video-popup.active .videoWrapper').children('iframe').attr('src');    
       
    $('.inf-video-popup.active .videoWrapper').children('iframe').attr('src', '');
    $('.inf-video-popup.active .videoWrapper').children('iframe').attr('src', $vidsrc);

    // var $tiksrc =  $('.inf-video-popup.active .tiktok-embed').children('iframe').attr('src');    
    // $('.inf-video-popup.active .tiktok-embed').children('iframe').attr('src', '');    
    // $('.inf-video-popup.active .tiktok-embed').children('iframe').attr('src', $tiksrc);
    
    $(".inf-video-popup.active,.inf-trigger.active,.inf-video-overlay.active,.popup-cross.active").removeClass("active");
    
    console.log("Youtube " + $vidsrc);
    console.log("TIktok " + $tiksrc);
  });

});

  
</script>

{% schema %}
{
  "name": "Reviews - Influencers",
  "settings": [
    {
      "type": "color",
      "id": "custom_background_color",
      "label": "Background color",
      "default": "#fff"
    },
    {
      "type": "select",
      "id": "wrapper",
      "label": "Page Width",
      "default": "Standard Width",
      "options": [
        {
          "value":"Full Width",
          "label":"Full Width"
        },
        {
          "value":"Standard Width",
          "label":"Standard Width"
        },
        {
          "value":"Small Width",
          "label":"Small Width"
        }
      ]
    },
    {
      "type": "select",
      "id": "wrapper_padding",
      "label": "Section Padding",
      "default": "Padding Top & Bottom",
      "options": [
        {
          "value":"Padding Top & Bottom",
          "label":"Padding Top & Bottom"
        },
        {
          "value":"Padding Top Only",
          "label":"Padding Top Only"
        },
        {
          "value":"Padding Bottom Only",
          "label":"Padding Bottom Only"
        },
        {
          "value":"No Padding",
          "label":"No Padding"
        }
      ]
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title"
    },
    {
      "type": "header",
      "content": "Number of Columns"
    },
    {
      "type": "select",
      "id": "large_columns",
      "label": "Large Desktop Columns",
      "default": "4 Per Column",
      "options": [
        {
          "value":"6 Per Column",
          "label":"6 Per Column"
        },
        {
          "value":"5 Per Column",
          "label":"5 Per Column"
        },
        {
          "value":"4 Per Column",
          "label":"4 Per Column"
        },
        {
          "value":"3 Per Column",
          "label":"3 Per Column"
        },
        {
          "value":"2 Per Column",
          "label":"2 Per Column"
        }
      ]
    },
    {
      "type": "select",
      "id": "desktop_columns",
      "label": "Desktop Columns",
      "default": "4 Per Column",
      "options": [
        {
          "value":"6 Per Column",
          "label":"6 Per Column"
        },
        {
          "value":"5 Per Column",
          "label":"5 Per Column"
        },
        {
          "value":"4 Per Column",
          "label":"4 Per Column"
        },
        {
          "value":"3 Per Column",
          "label":"3 Per Column"
        },
        {
          "value":"2 Per Column",
          "label":"2 Per Column"
        }
      ]
    },
    {
      "type": "select",
      "id": "laptop_columns",
      "label": "Laptop Columns",
      "default": "4 Per Column",
      "options": [
        {
          "value":"5 Per Column",
          "label":"5 Per Column"
        },
        {
          "value":"4 Per Column",
          "label":"4 Per Column"
        },
        {
          "value":"3 Per Column",
          "label":"3 Per Column"
        },
        {
          "value":"2 Per Column",
          "label":"2 Per Column"
        }
      ]
    },
    {
      "type": "select",
      "id": "tablet_columns",
      "label": "Tablet Columns",
      "default": "2 Per Column",
      "options": [
        {
          "value":"3 Per Column",
          "label":"3 Per Column"
        },
        {
          "value":"2 Per Column",
          "label":"2 Per Column"
        },
        {
          "value":"Single Column",
          "label":"Single Column"
        }          
      ]
    },
    {
      "type": "select",
      "id": "mobile_columns",
      "label": "Mobile Columns",
      "default": "Single Column",
      "options": [
        {
          "value":"2 Per Column",
          "label":"2 Per Column"
        },
        {
          "value":"Single Column",
          "label":"Single Column"
        }
      ]
    }
  ],
  "blocks": [
    {
      "type": "text",
      "name": "Review Block",
      "limit": 12,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "html",
          "id": "youtube",
          "label": "YouTube Share Link"
        },
        {
          "type": "html",
          "id": "tiktok",
          "label": "Tiktok Share Link"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Reviews - Influencers",
      "category": "Custom"
    }
  ]
}
{% endschema %}